---
title: "Jackson do Pandeiro - The king of rithm"
subtitle: 'Analysis with interactive visualizations about Jackson do Pandeiro on data from Spotify'
author: "José Benardi de Souza Nunes"
output:
  html_notebook:
    toc: yes
    toc_float: yes
  html_document:
    df_print: paged
    toc: yes
    toc_float: yes
---

<br>

***

<br>

## Employed dataset

Exploratory data analysis on data from [Spotify](https://www.spotify.com/br/) about the albums and musics of Jackson do Pandeiro. The original data come from [this repository](https://github.com/cienciadedados-ufcg/vis-cancoes). The explanation about how the data were generatedis available [at the Spotify API documentation](https://beta.developer.spotify.com/documentation/web-api/reference/object-model/#audio-features-object).

### Considerations

In the analysis below we could:

* See how speech was not the real core of dancability of Jackson's songs, which was to be expected from the **King of rithm**.
* See how on Spotify most albums are remastered/relaunched and those are the most popular.
* Glimpse the incredible diversity of the singer which was reaffirmed in terms of musical notes and length.
* Realize how tone and track duration of Jackson's songs do not only represent the incredible diversity of his music, but also represent his private life. An event in his private life impacts sensibly the tone of his music. 

```{r setup, echo=FALSE, warning=FALSE, message=FALSE}
library(tidyverse)
library(dplyr, warn.conflicts = FALSE)
library(here)
library(plotly)
library(scales)
library(highcharter)
library(stringr)
theme_set(theme_bw())
```

## Data Overview

```{r}
data <- read_csv(here::here("data/jackson.csv"), 
                            col_types = cols(
                                .default = col_double(),
                                album_uri = col_character(),
                                album_name = col_character(),
                                album_img = col_character(),
                                album_release_date = col_character(),
                                album_release_year = col_date(format = ""),
                                album_popularity = col_integer(),
                                track_name = col_character(),
                                track_uri = col_character(),
                                key = col_character(),
                                mode = col_character(),
                                time_signature = col_integer(),
                                key_mode = col_character(),
                                track_popularity = col_integer()
                                )) %>%
         mutate(album_name = gsub(".*(1954).*",
                                         "The Music of Brazil/Jackson do Pandeiro",
                                  album_name));
data %>% 
    glimpse()
```

### Danceability

```{r}
data %>% 
    ggplot(aes(sample=danceability)) + 
        stat_qq()
```

```{r}
hchart (data$danceability,
        color = "#B71C1C",
        name = "Danceability")
```

* No value outside expected domain, danceability seems to vary around 0.6 and 0.7.

### Speechiness

```{r}
data %>% 
    ggplot(aes(sample=speechiness)) + 
        stat_qq()
```

```{r}
hchart (data$speechiness,
        color = "#B71C1C",
        name = "Speechiness")
```

* No value outside expected domain. Speechiness is overall small. Observing Jackson's music rithm seems to be its trademark,  with short and almost repetitive lyrics.

### Duration

```{r}
data <- data %>%
    mutate(duration_s = duration_ms/1000)

data %>% 
    select(duration_s) %>%
    glimpse()
```


```{r}
data %>% 
    ggplot(aes(sample=duration_s)) + 
        stat_qq()
```

```{r}
hchart (data$duration_s,
        color = "#B71C1C",
        name = "Duration (s)")
```

* No value outside expected domain. Songs on average last 160 seconds (2 minutes and 40 seconds), Jackson's songs are overall very short.

### Remastered

```{r}
data <- data %>%
    mutate(remastered = album_release_date > "1981-30-12")

data %>% 
    select(album_name, album_release_year, remastered) %>%
    sample_n(10)
```


```{r}
temp <- data %>% 
    distinct(album_name,
             .keep_all = TRUE) %>%
    mutate(remastered = ifelse(remastered == TRUE,"remastered","original"))

hchart(temp$remastered,
       colorByPoint = TRUE,
       name="Álbum")
```

* Remastered/Relaunched albums are very frequent.

```{r}
temp <-
    data %>% 
    distinct(album_name, .keep_all = TRUE) %>%
    group_by(album_release_year) %>%
    summarise(original_n = sum(!remastered),
              remastered_n = sum(remastered))

highchart() %>%

  hc_xAxis(categories = temp$album_release_year) %>%
  hc_add_series(temp$original_n, 
                type = "column",
                color = "#B71C1C",
                name = "Not remastered") %>%
  hc_add_series(temp$remastered_n, 
                type = "column",
                name = "Remastered")  %>%
      hc_title(text = "Number of albums per year")

```

* On 2016 we have a huge increase on the provision of Jackson's albums on Spotify.

## More dialog/vocals (speechines) impacts the danceability of the song?

```{r}
p <- data %>% 
        distinct(track_name, .keep_all = TRUE) %>%
        ggplot(aes(x=speechiness,
                   y=danceability)) +
        geom_point(alpha=0.4) 

ggplotly(p)
```

<br></br>

There doesn't seem to be a clear relation between the danceability of Jackson's songs and their speechiness. We have many tracks of different levels of danceability and on the same low level of speechiness. 
When we increase the speechiness of the songs (more to the right of the x axis) the danceability stays relatively stable (The increase in danceability is marginal).

```{r}
data %>% 
    distinct(track_name, .keep_all = TRUE) %>%
    ggplot(aes(speechiness,danceability)) +
    stat_density2d(aes(fill = ..level..), geom = "polygon") +
    scale_x_continuous(breaks = seq(0,1,0.01))

```

<br></br>

It's possible to see more clearly that point of higher occurrences (area of highest level) is around 0.7 of danceability and 0.04 of speechiness (a very low level of speechiness). 
This implies something we expected, Jackson doesn't need to talk much to make their songs highly danceable, it's for good reason that Jackson was nicknamed **the king of rithm**.

* The increase in speechiness doesn't seem to affect danceability significantly.
* Speechiness wouldn't be the actual reason for the considerably danceability of Jackson's music, who's notorious for the beat and rithm of his songs (who was even named the best percussionist of the popular brazilian music). 

## How the years affect the length of the tracks?

```{r}
m <- list(
  l =70,
  b = 150)

p <- data %>% 
    ggplot(aes(x=as.factor(album_release_year),
               duration_s,
               group=album_release_year,
               color=remastered)) +
    geom_boxplot(position = "dodge", alpha=0.6) +
    theme(axis.text.x = element_text(angle = 30, hjust = 1)) +
    labs(x="Album release year", y="Track duration (s)")

ggplotly(p) %>%
     layout(autosize = F, margin=m)
```

Olhando para os álbuns originais (remastered = FALSE) é possível perceber um grande aumento no tempo de duração das músicas no álbum em 1967 seguido de uma diminuição no álbum seguinte 1968. Esse choque no perfil dos dois álbuns requer uma explicação que não está nos dados.

O álbum de 1967 **A Braza do Norte**, primeiro gravado na gravadora Cantagalo marca também um momento especial na vida do cantor, pois esse é o ano de seu divórcio de Almira, parceira na música e esposa. De músicas mais longas e de faixas de letra mais triste como **"Passarinho abandonado"** composta pelo próprio Jackson, esse perfil incomum do álbum acaba por refletir esse momento da vida do cantor.

O álbum de 1968 por outro lado é uma coletânea e reúne algumas das músicas até então mais populares (e tambpem curtas do cantor). Essa coletânea casa com um inaudito porém curto hiato do cantor que pela primeira vez passa um ano sem publicar um álbum, o qual pode ser atribuído ao seu divórcio.

* Os álbuns remasterizados/relançados reúnem faixas algumas vezes de diferentes momentos da carreira do cantor, e por isso fica difícil atribuir um significado pertinente à duração de suas faixas. 


## Os albuns relançados/remasterizados são mais populares? 

```{r}
# lollipop chart
m <- list(
  l = 370)

p <- data %>%
    ggplot(aes(album_popularity,y=reorder(album_name,album_popularity),
               group=remastered)) +
    geom_segment(aes(x = 0, y = reorder(album_name,album_popularity),
                     xend = album_popularity, yend = album_name)) +
    geom_point(aes(color=remastered)) +
    theme(axis.title.y=element_blank()) +
    scale_color_discrete(" Remastered")

ggplotly(p,tooltip=NA) %>%
  layout(autosize = F,
         margin = m)
```

Fica evidente que para Jackson do Pandeiro **os álbuns remasterizados/relançados dominam o cenário do Spotify em termos de popularidade**. 
Primeiramente, simplesmente observando a proporção entre remasterizados e não remasterizados fica evidente que os primeiros são os que o Spotify mais disponibiliza. Segundo, levando em consideração a questão de qualidade de áudio era de se esperar que os remasterizados tomassem a dianteira.

## Como o tempo afeta a distribuição das notas musicais ?

```{r}
tim12equal = c("#00008F", "#0000EA", "#0047FF", "#00A2FF", "#00FEFF", "#5AFFA5", "#B5FF4A", "#FFED00", "#FF9200", "#FF3700", "#DB0000", "#800000")


m <- list(
    l=45,
    r=40);

p <-  data %>%
    select(key,album_release_date, remastered) %>%
    group_by(album_release_date,key,remastered) %>%
    summarise(counted = n()) %>%
    ungroup() %>%
    group_by(album_release_date) %>%
    mutate(rel_freq = counted/sum(counted)) %>%
    ggplot(aes(x = factor(album_release_date),
               y = rel_freq,
               fill = factor(key),
               text = paste(
                    "Proportion:",
                    round(rel_freq * 100,2),"%"))) +
    geom_col() +
    scale_y_continuous(labels = scales::percent) +
    scale_fill_manual(values = tim12equal) +
    theme(axis.text.x = element_text(angle = 30, hjust = 1))  +
    theme(axis.title.x=element_blank(),
          axis.title.y=element_blank()) +
    facet_wrap(remastered ~ ., nrow = 2) +
    ggtitle("Notas musicais (distinção por remasterização)") +
    guides(fill=guide_legend(title="Musical\nNotes")) 

ggplotly(p, tooltip="text") %>%
      layout(autosize = F,
             margin = m,
             legend = list(
      orientation = "h", y =-0.2
    )) %>%
    layout(legend = list(
      orientation = "v"
    ))

```

* É possível ver que no começo dos anos 1960 ínicio as músicas na escala entre E e G dominam fortemente o repertório de Jackson, curiosamente quando as músicas de notas entre A e C chegam a ocupar metade das ocorrências.   
    + Isso está de acordo com o perfil de Jackson, notório por sua heterogeneidade, além disso o álbum de 1967 como foi dito anteriormente representa uma mudança no tom do cantor também por motivos pessoais (seu divórcio).  
 * Os álbuns remasterizados refletem uma grande variação em termos de notas musicais já esperada dado que esse conjuto reúne uma quase caótica série de coletâneas, seleções diversas e relançamentos que acabam misturando momentos diferentes da carreira do cantor.  
    + O fato de Jackson se entregar a diversos estilos musicais śo multiplica essa variação em termos de notas musicais (Jackson se envolveu com baião, xote, xaxado, coco, arrastapé, quadrilha, marcha, frevo, **e outros**), isso fica evidente na variação já nos álbuns não remasterizados.
